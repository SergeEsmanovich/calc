<div id='new_maket' class='container'>
    <div>
        <div class="big_block">
            <div class='title'>
                <span class="pull-left">Выбор промышленного светильника</span>
                <span ng-click="help1 = 1" class="help pull-left"  >?</span>
                <div class="help_block pull-left">

                    <div ng-show="help1" class="help_content">
                        <div  ng-click="help1 = 0" class="close">x</div>
                        <p>При помощи фильтров отбора вы можете убрать из результатов расчетов все ненужные варианты светильников.</p>
                        <p>Если же вы знаете конкретную модель светильника, просто выберите ее в фильтре "Серия" или "Название"</p>
                        <p>Для запуска расчета необходимо применить хотя бы один фильтр отбора светильника</p>
                    </div>
                </div>
                <div class="clear"></div>
            </div>
            <div class="border-right">
                <div class="block">
                    <div><label>Тип лампы (тип светильника)</label></div>
                    <div>
                        <ul class="list-inline">
                            <li ng-repeat="type_lamp in DBheader.type_lamp track by $index">
                                <input  ng-click="DBheader.type_lamp_check(type_lamp.id)" type="checkbox">
                                <label>{{type_lamp.name}}</label>
                            </li>
                        </ul>

                    </div>
                    <div class="level_of_protection">
                        <label class="mr">Степень защиты IP</label>
                        <label class="black">от</label>
                        <input ng-blur="DBheader.ip_begin_valid()" ng-model="DBheader.ip_begin" class="mr  form-control" type="text">
                        <label class="black">до</label>
                        <input ng-blur="DBheader.ip_end_valid()" ng-model="DBheader.ip_end" class="form-control" type="text">
                    </div>
                </div>
                <div class="border power_lamp">
                    <div>
                        <label>Мощность светильника, Вт</label>
                    </div>
                    <div>
                        <div class="inline">
                            <label class="black">от</label>
                            <input class="mr  form-control" ng-model="DBheader.power[0]" type="text">
                            <label class="black">до</label>
                            <input  class="form-control" ng-model="DBheader.power[1]" type="text">
                        </div>
                        <div class="inline slider">
                            <div class="slide">
                                <div ui-slider="{range: true}" min="10" max="400" step="10"   ng-model="DBheader.power">
                                </div> 
                            </div>
                        </div>
                    </div>
                </div>
                <div class="clear"></div>
                <div class="pribor">
                    <div class="inline">
                        <div class="select">
                            <div class="label red">
                                <span>Серия</span>
                            </div>
                            <div class="item">
                                <!--                                <ui-select ng-model="area.seria">
                                                                    <ui-select-match placeholder="">{{$select.selected.seria}}</ui-select-match>
                                                                    <ui-select-choices group-by="'groupe'" repeat="item in DBheader.filtred_seria">
                                                                        <div ng-bind-html="item.seria | highlight: $select.search"></div>
                                                                    </ui-select-choices>
                                                                </ui-select>-->
                                <select class="form-control" ng-model="area.seria" convert-to-number>
                                    <option ng-value="item.id" ng-repeat="item in DBheader.filtred_seria  track by $index">
                                        {{item.seria}}
                                    </option>
                                </select> 
                            </div>
                        </div>
                    </div>
                    <div class="inline"> 
                        <div class="select">
                            <div class="label red">
                                <span>Название</span>
                            </div>
                            <div class="item name">
                                <select ng-disabled="DBheader.disable_sel_name" class="form-control" ng-model="area.pribor" convert-to-number>
                                    <option ng-value="item.id" ng-repeat="item in DBheader.content  track by $index">
                                        {{item.name}}
                                    </option>
                                </select> 
                            </div>
                            <div class="clear"></div>
                        </div>
                    </div>
                    <div class="image">
                        <img src="{{DBheader.image}}" alt="">
                    </div>
                </div>

            </div>   
        </div>
        <div class="big_block">
            <div class='title'>Параметры помещения</div>
            <div class="block params_area">
                <div class="pull-left params">
                    <div>
                        <label class="pull-left" >Высота потолков, м</label>
                        <input ng-model="area.height.val"  class="form-control pull-left" type="text">
                    </div>
                    <div class="clear"></div>
                    <div>
                        <label class="pull-left">Длинна подвеса, м</label>
                        <input ng-model="area.lamp_location_height.val" class="form-control pull-left" type="text">
                        <span ng-click="help2 = 1" class="help pull-left" >?</span>
                        <div class="help_block pull-left">
                            <div ng-show="help2" class="help_content">
                                <div  ng-click="help2 = 0" class="close">x</div>
                                <p>Длинна троса, на котором подвешен светильник или расстояние от потолка до точки подвеса светильника</p>
                                <p><center><img src="/images/help2.png" alt=""></center></p>
                            </div>
                        </div>
                    </div>
                    <div class="clear"></div>   
                </div>
                <div class="pull-right params">
                    <div>
                        <label>Длинна, м</label>
                        <input  ng-model="area.length.val" class="form-control" type="text">
                    </div>
                    <div>
                        <label>Ширина, м</label>
                        <input  ng-model="area.width.val" class="form-control" type="text">
                    </div>
                </div>
            </div>
            <div class="clear"></div>
            <div class="border">
                <div>
                    <span ng-click="help3 = 1" class="pull-right help"  >?</span>
                    <div class="help_block help3 pull-right">
                        <div ng-show="help3" class="help_content">
                            <div  ng-click="help3 = 0" class="close">x</div>
                            <p>Указав тип помещения и степень его загрязнения программа автоматически 
                                подберет значение коэффициентов запаса (Кз) 
                                согласно эксплуотационной группе светильника по СП 52.13330.2011</p>
                            <p>Неверно выбранная степень загрязнения может привести к ошибке до 30% в расчете необходимого количества светильников.</p>
                            <p>Вы можете вручную указать подобранные вами коэффициент запаса (Кз) или коэффициент эксплуатации (Кэ). Обратите внимание, что они связаны соотношением Кз=1/Кэ.</p>

                        </div>
                    </div>
                </div>
                <div  class="pull-left typearea">
                    <label>Тип помещения</label>
                </div>
                <div class="pull-left">
                    <ul class="list-unstyled">
                        <li>
                            <input ng-model="area.type" value="0" type="radio">
                            <label>Производственное</label>
                        </li>
                        <li>
                            <input ng-model="area.type" value="1" type="radio">
                            <label>Общественное или жилое</label>
                        </li>
                    </ul>
                </div>
                <div class="clear"></div>
                <div class="pull-left typearea">
                    <label>Уровень загрязнения</label>
                </div>
                <div class="pull-left pollution_level">
                    <select class="form-control" ng-model="area.pollution" convert-to-number>
                        <option ng-selected="$index == area.pollution"  value="{{$index}}"  ng-value="$index" ng-repeat="item in pollution| filter:{type:area.type} track by $index">
                            {{item.name}}
                        </option>
                    </select> 
                </div>
                <div class="clear"></div>
                <hr>
                <div class="factors">
                    <div class="pull-left">
                        <span>
                            Коэффициент запаса
                        </span>
                        <input ng-model="area.safety_factor"  class="form-control" type="text">
                    </div>
                    <div class="pull-right">
                        <span>
                            Коэффициент эксплуатации
                        </span>
                        <input ng-model="area.service_factor" class="form-control" type="text">
                    </div>
                    <div class="clear"></div>
                </div>
            </div>
            <div class="border reflections">
                <div>
                    <label>Коэффициенты отражения материалов отделки</label>
                    <span class="pull-right help" ng-click="help4 = 1"  >?</span>
                    <div class="help_block help3 pull-right">
                        <div ng-show="help4" class="help_content">
                            <div  ng-click="help4 = 0" class="close">x</div>
                            <p> Для более точного расчета рекомендуем уточнить коэффициенты отражения для вашего помещения согласно таблице</p>
                            <table class="table">
                                <tr>
                                    <th>Материал</th>
                                    <th>&rho;</th>
                                </tr>
                                <tr ng-repeat="item in help_material_table">
                                    <td>{{item.name}}</td>
                                    <td>{{item.ref}}</td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="content">
                    <div class="pull-left mr">
                        <b><span>По умолчанию &rho; потолка, стены и пола</span></b>
                    </div>
                    <div class="pull-left select">
                        <select class="form-control" ng-model="area.reflection" convert-to-number>
                            <option ng-selected="$index == area.reflection" value="{{$index}}" ng-value="$index" ng-repeat="item in reflections track by $index">
                                {{item}}
                            </option>
                        </select> 
                    </div>
                    <div class="clear"></div>
                </div>
            </div>
            <div class="title">
                Параметры освещения
            </div>
            <div class="border params_light">
                <div class="head">
                    <span class="pull-right help"  ng-click="help5 = 1">?</span>
                    <div class="help_block help3 pull-right">
                        <div ng-show="help5" class="help_content">
                            <div  ng-click="help5 = 0" class="close">x</div>
                            <p>Необходимый уровень освещенности согласно типу работ производимых в помещении можно выбрать по следующим таблицам из нормативных документов:</p>
                            <p><a href="">СП 52.13330.2011</a></p>
                            <p>таблицы №1-3 (стр. 3-10)</p>
                            <p><a href="">ГОСТ Р 55710-2013</a></p>
                            <p>таблицы №6-42 (стр. 4-13)</p>
                        </div>
                    </div>
                    <label>Освещенность, лк</label>
                    <input class="form-control" type="text" ng-model="area.medium_light">
                </div>

                <div>
                    <div class="pull-left r_groupe">
                        <span><input ng-model="area.height_working_plane" value="0"  type="radio"><label class="black" for="">на полу</label></span>
                        <span><input ng-model="area.height_working_plane"  value="0.8"  type="radio"><label  class="black" for="">на столах</label></span>
                    </div>
                    <div class="pull-left slider">
                        <div class="slide">
                            <div ui-slider min="100" max="1000" step="10" ng-model="area.medium_light"></div>
                        </div>
                    </div>
                    <div class="clear"></div>
                </div>
            </div>
        </div>
        <div class="clear"></div>
    </div>
    <div class="block">
        <button ng-click="calculate()" class="pull-right calculate">Рассчитать</button>
    </div>
    <div>
        <div class="title">Результаты расчета</div>
        <table class="table table-hover">
            <tr>
                <th>№</th>
                <th>Название</th>
                <th>Артикул</th>
                <th>Тип лампы</th>
                <th>
                    <span>Положение лампы</span>
                    <span class="pull-right help" ng-click="help6 = 1" >?</span>
            <div class="help_block help6 pull-right">
                <div ng-show="help6" class="help_content">
                    <div  ng-click="help6 = 0" class="close">x</div>
                    <p>Изменение положения лампы ДРИ (МГЛ) и ДРЛ  в светильнике позволяет сократить необходимое количество светильников благодаря более рациональному освещению поверхности.</p>
                    <div class="pull-left"><img src="/images/loc.png" alt=""></div>
                    <p>Положение лампы необходимо указать
                        при заказе светильника.</p>
                    <p>Цена светильника не зависит от
                        положения лампы.</p>
                    <p>Если в расчете не указано положение
                        лампы, значит оно не регулируется.</p>
                    <div class="clear"></div>
                </div>
            </div>
            </th>
            <th class="filtr" ng-click="reverse = !reverse; order('lamp_power', reverse)"><span>Мощность светильника, Вт</span></th>
            <th class="filtr" ng-click="reverse = !reverse; order('col_lamp', reverse)"><span>Количество светильников</span></th>
            <th>Расчетный коэф. запаса Кз</th>
            <th class="filtr" ng-click="reverse = !reverse; order('summ_power', reverse)"><span>Мощность установки, кВт</span></th>
            <th>Рекомендуемое кол-во чисток в год</th>
            </tr>
            <tr ng-show="view_result" ng-repeat="lamp in DBheader.calculation track by $index">
                <td>{{$index + 1}}</td>
                <td>{{lamp.name}}</td>
                <td>{{lamp.article}}</td>
                <td>{{DBheader.get_type_lamp(lamp.type_lamp_id)}}</td>
                <td>{{lamp.location}}</td>
                <td>{{DBheader.get_power_lamp(lamp.power_lamp_id)}}</td>
                <td>{{lamp.col_lamp}}</td>
                <td>{{lamp.safety_factor}}</td>
                <td>
                    {{lamp.summ_power}}
                </td>
                <td>{{pollution[area.pollution].col_clear}}</td>
            </tr>
        </table>
    </div>
</div>